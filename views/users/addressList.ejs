<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SeatWorld - My Account - Address</title>

  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />

  <link rel="stylesheet" href="/css/users/profile.css">
  <link rel="stylesheet" href="/css/users/addressList.css">
  <script src="/js/common/pagination.js" defer></script>
</head>

<body class="bg-gray-100 text-gray-800">
  <!-- Overlay -->

  <!-- Mobile Menu Button -->
  <%- include('../partials/profileMobileToggle') %>
    <%- include('../partials/header', { showSearch: false }) %>
      <%- include("../partials/breadcrumb", { breadcrumbs }) %>
        <%- include("../partials/flash", { messageData: locals.message }) %>

          <!-- MAIN -->
          <main class="container">
            <div class="profile-layout">

              <!-- Sidebar -->
              <%- include('../partials/profileSidebar', { active: 'address' }) %>

                <!-- ADDRESS CONTENT -->
                <section class="main-content">
                  <div class="bg-white rounded-lg border shadow-sm p-6">

                    <div class="flex justify-between items-center mb-6">
                      <h2 class="text-2xl font-semibold">Address</h2>
                      <a href="/address/add"
                        class="bg-gray-700 text-white px-4 py-2 rounded-lg hover:bg-gray-800 flex items-center gap-2">
                        <span class="material-icons-outlined text-sm">add</span>
                        Add New
                      </a>
                    </div>

                    <% if (addresses && addresses.length) { %>
                      <div class="grid md:grid-cols-2 gap-6">
                        <% addresses.forEach(address=> { %>
                          <div class="address-card <%= address.isDefault ? 'is-default' : '' %> rounded-lg p-4">
                            <!-- Default Badge -->
                            <% if (address.isDefault) { %>
                              <span class="default-badge">
                                <span class="material-icons-outlined" style="font-size: 14px;">check_circle</span>
                                Default Address
                              </span>
                              <% } %>

                                <h3 class="font-bold mt-2">
                                  <%= address.name %>
                                </h3>
                                <p class="text-sm text-gray-600 mt-1">
                                  <%= address.city %>, <%= address.state %> - <%= address.pincode %>
                                </p>
                                <p class="text-sm mt-1">Mobile: <%= address.mobile %>
                                </p>

                                <!-- Action Buttons -->
                                <div class="flex gap-2 mt-4">
                                  <a href="/address/edit/<%= address._id %>"
                                    class="flex-1 bg-gray-800 text-white py-2 rounded text-center hover:bg-gray-900 flex items-center justify-center gap-2">
                                    <span class="material-icons-outlined text-sm">edit</span>
                                    Edit
                                  </a>
                                  <button class="delete-btn flex items-center justify-center gap-2"
                                    onclick="openDeleteModal('<%= address._id %>')">
                                    <span class="material-icons-outlined text-sm">delete</span>
                                    Delete
                                  </button>
                                </div>

                                <!-- Set Default Button -->
                                <% if (!address.isDefault) { %>
                                  <button class="set-default-btn w-full mt-2"
                                    onclick="setDefaultAddress('<%= address._id %>')">
                                    <span class="material-icons-outlined" style="font-size: 16px;">star_border</span>
                                    Set as Default
                                  </button>
                                  <% } else { %>
                                    <button class="set-default-btn active w-full mt-2" disabled>
                                      <span class="material-icons-outlined" style="font-size: 16px;">star</span>
                                      Default Address
                                    </button>
                                    <% } %>
                          </div>
                          <% }) %>
                      </div>
                      <% } else { %>
                        <div class="text-center py-20">
                          <span class="material-icons-outlined text-gray-300"
                            style="font-size: 80px;">location_off</span>
                          <p class="text-gray-500 mt-4">No addresses found</p>
                          <a href="/address/add"
                            class="inline-block mt-4 bg-gray-700 text-white px-6 py-2 rounded-lg hover:bg-gray-800">
                            Add Your First Address
                          </a>
                        </div>
                        <% } %>

                  </div>
                </section>
            </div>
          </main>



          <!-- Pagination -->
          <%- include('../partials/pagination', { pagination, query: '' }) %>

            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
            <script type="module" src="/js/users/addressList.js"></script>

            <%- include('../partials/footer') %>

</body>

</html>